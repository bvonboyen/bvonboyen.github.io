<h1>Posts tagged with ‘{{ page.tag | default: page.taxonomy }}’</h1>

{%- assign want = page.tag | default: page.taxonomy | downcase | strip -%}
{%- assign posts_for_tag = '' | split: '' -%}

{%- for t in site.tags -%}
  {%- assign tag_key = t[0] | downcase | strip -%}
  {%- if tag_key == want -%}
    {%- assign posts_for_tag = posts_for_tag | concat: t[1] -%}
  {%- endif -%}
{%- endfor -%}

{%- assign urls = posts_for_tag | map: 'url' | uniq -%}

{%- if urls and urls.size > 0 -%}
  <ul>
  {%- for u in urls -%}
    {%- assign post = posts_for_tag | where: 'url', u | first -%}
    <li>
      <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
      <small>— {{ post.date | date: "%B %d, %Y" }}</small>
    </li>
  {%- endfor -%}
  </ul>
{%- else -%}
  <p>No posts found with tag ‘{{ page.tag | default: page.taxonomy }}’.</p>
{%- endif -%}
